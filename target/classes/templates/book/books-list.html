<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Library Catalog - Bookshelf Pro</title>

<!-- Modern Google Font -->
<link href="https://fonts.googleapis.com" rel="stylesheet">
<!-- Bootstrap 5.3 CSS -->
<link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet">
<!-- Bootstrap Icons -->
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

<style>
:root { -
    -primary-color: #4361ee; -
    -secondary-color: #3f37c9; -
    -bg-light: #f8f9fc; -
    -danger-soft: #fff1f2; -
    -danger-text: #e11d48;
}

body {
    background-color: var(- -bg-light);
    font-family: 'Inter', sans-serif;
    color: #333;
}

/* Navbar Styling (same as Category page) */
.navbar {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%) !important;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.navbar-brand {
    font-weight: 700;
    letter-spacing: -0.5px;
}

/* Card &amp; Table Styling (same as Category) */
.main-card {
    border: none;
    border-radius: 12px;
    background: #ffffff;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    margin-top: 2rem;
}

.table {
    vertical-align: middle;
}

.table thead {
    background-color: #f1f5f9;
    border-bottom: 2px solid #e2e8f0;
}

.table thead th {
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
    color: #64748b;
    padding: 1rem;
}

.table tbody tr {
    transition: all 0.2s;
}

.table tbody tr:hover {
    background-color: #f8fafc;
}

/* Category-style ‚Äúbadge‚Äù for Category column */
.badge-cat {
    background-color: #eef2ff;
    color: var(- -primary-color);
    font-weight: 600;
}

/* Buttons */
.btn-add {
    background-color: var(- -primary-color);
    border: none;
    font-weight: 600;
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    transition: transform 0.2s;
    color: white;
    text-decoration: none;
}

.btn-add:hover {
    background-color: var(- -secondary-color);
    transform: translateY(-1px);
    color: white;
}

.btn-outline-secondary {
    border-radius: 10px;
}

/* Floating Checkout Pill (kept from your original, fits theme) */
.cart-floating-trigger {
    position: fixed;
    top: 90px; /* below navbar */
    right: 30px;
    z-index: 1050;
}

.checkout-pill {
    display: flex;
    align-items: center;
    background: linear-gradient(135deg, var(- -primary-color),
        var(- -secondary-color));
    color: white !important;
    text-decoration: none;
    padding: 12px 24px;
    border-radius: 50px;
    box-shadow: 0 10px 25px rgba(67, 97, 238, 0.3);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.checkout-pill:hover {
    transform: scale(1.05) translateY(-3px);
    box-shadow: 0 15px 35px rgba(67, 97, 238, 0.4);
}

.cart-info-group {
    display: flex;
    align-items: center;
    gap: 10px;
    border-right: 1px solid rgba(255, 255, 255, 0.3);
    padding-right: 15px;
    margin-right: 15px;
}

.cart-count-big {
    font-size: 1.4rem;
    font-weight: 800;
    color: #ffca28;
}

.checkout-text {
    font-weight: 700;
    letter-spacing: 0.5px;
    font-size: 0.9rem;
}

/* Primary add-to-cart button styled to match palette */
.btn-cart {
    background-color: var(- -primary-color);
    color: #fff !important;
    border-radius: 10px;
    font-weight: 600;
    transition: 0.2s;
}

.btn-cart:hover {
    background-color: var(- -secondary-color);
    transform: translateY(-1px);
}
</style>

<!-- üîπ ONLY ADD-TO-CART & CHECKOUT COLOR OVERRIDES BELOW (no other changes) -->
<style>
/* New theme just for Add to Cart and Checkout */
:root {
  --cart-color: #059669;        /* emerald 600 */
  --cart-color-hover: #047857;  /* emerald 700 */
  --checkout-start: #f59e0b;    /* amber 500 */
  --checkout-end: #d97706;      /* amber 600 */
  --checkout-shadow: rgba(245, 158, 11, 0.35);
  --checkout-shadow-hover: rgba(245, 158, 11, 0.45);
}

/* Override ONLY the checkout pill colors */
.checkout-pill {
  background: linear-gradient(135deg, var(--checkout-start), var(--checkout-end)) !important;
  box-shadow: 0 10px 25px var(--checkout-shadow) !important;
  border: 2px solid rgba(255,255,255,0.15) !important;
}
.checkout-pill:hover {
  box-shadow: 0 15px 35px var(--checkout-shadow-hover) !important;
}

/* Override ONLY the Add to Cart button colors */
.btn-cart {
  background-color: var(--cart-color) !important;
  border: 1px solid rgba(0,0,0,0.03) !important;
}
.btn-cart:hover {
  background-color: var(--cart-color-hover) !important;
}
</style>
</head>
<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" th:href="@{/books/list}">üìö <span
                class="ms-2">BOOKSHELF PRO</span></a>
            <button class="navbar-toggler" type="button"
                data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="navbar-nav ms-auto">
                    <a class="nav-link text-white-50" th:href="@{/authors/list}">Authors</a>
                    <a class="nav-link text-white-50" th:href="@{/inventories/list}">Inventory</a>
                    <a class="nav-link text-white-50" th:href="@{/category/list}">Categories</a>
                    <a class="nav-link text-white-50" th:href="@{/publishers/list}">Publishers</a>
                    <a class="nav-link text-white-50" th:href="@{/users/list}"
                        th:if="${session.loggedInUser != null && session.loggedInUser.role == 'ADMIN'}">Users</a>

                    <form th:action="@{/logout}" method="post" class="ms-lg-3">
                        <input type="hidden" th:name="${_csrf.parameterName}"
                            th:value="${_csrf.token}" />
                        <button type="submit"
                            class="btn btn-link nav-link text-danger border-0">Logout</button>
                    </form>
                </div>
            </div>
        </div>
    </nav>
   


    <!-- FLOATING CART PILL (kept) -->
    <div class="cart-floating-trigger"
        th:if="${session.cart != null && session.cart.size() > 0}">
        <a th:href="@{/cart/checkout}" class="checkout-pill">
            <div class="cart-info-group">
                <i class="bi bi-cart3 fs-4"></i> <span class="cart-count-big"
                    th:text="${session.cart.size()}">0</span>
            </div> <span class="checkout-text">CHECKOUT</span>
        </a>
    </div>

    <div class="container py-5">

        <!-- SUCCESS ALERT (unchanged, styled cleanly) -->
        <div th:if="${successMessage}"
            class="alert alert-success alert-dismissible fade show border-0 shadow-sm mb-4 p-3"
            role="alert" style="border-radius: 15px;">
            <div class="d-flex align-items-center">
                <i class="bi bi-check-circle-fill fs-4 me-3"></i> <strong
                    th:text="${successMessage}">Success!</strong>
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- MAIN CARD + TABLE -->
        <div class="col-md-6 text-md-end mt-3 mt-md-0"
            sec:authorize="hasRole('ADMIN')">
            <a th:href="@{/books/add}" class="btn btn-primary"
                style="border-radius: 8px; background-color: var(- -primary-color); border: none;">
                <i class="bi bi-journal-plus me-2"></i> Add New Book
            </a>
        </div>




        <div class="table-responsive">
            <table class="table table-borderless align-middle">
                <thead>
                    <tr>
                        <th>Book Title</th>
                        <th>Author</th>
                        <th>Category</th>
                        <th>Price</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="book : ${booksDTO}" class="border-bottom">
                        <td>
                            <div class="fw-bold text-dark" th:text="${book.title}">Title</div>
                            <small class="text-muted" th:text="${'ID: #BK-' + book.bookId}">ID:
                                #BK-0</small>
                        </td>
                        <td th:text="${book.author?.authorName}">Author</td>
                        <td><span class="badge badge-cat px-3 py-2 rounded-pill"
                            th:text="${book.category?.categoryName}">Category</span></td>
                        <td class="fw-bold text-primary" th:text="${'‚Çπ' + book.price}">‚Çπ0</td>
                        <td class="text-end">
                            <div class="d-flex justify-content-end gap-2">

                                <!-- ADD TO CART -->
                                <!-- ADD TO CART -->
<form th:action="@{/cart/add}" method="post" sec:authorize="hasRole('VIEWER')" class="m-0">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> 
    <input type="hidden" name="id" th:value="${book.bookId}" />
    
    <button type="submit" class="btn btn-sm btn-cart px-3 py-2 d-inline-flex align-items-center">
        <i class="bi bi-cart-plus me-2"></i> Add to Cart
    </button>
</form>


                                <!-- ADMIN EDIT (outlined style consistent with category edit) -->
                                <a th:href="@{/books/edit/{id}(id=${book.bookId})}"
                                    class="btn btn-sm btn-outline-secondary"
                                    sec:authorize="hasRole('ADMIN')" style="border-radius: 10px;">
                                    <i class="bi bi-pencil"></i>Edit
                                </a>

                                <!-- ADMIN EDIT (outlined style consistent with category edit) -->
                                <a th:href="@{/books/delete/{id}(id=${book.bookId})}"
                                    class="btn btn-sm btn-outline-danger d-inline-flex align-items-center"
                                    sec:authorize="hasRole('ADMIN')"
                                    style="border-radius: 10px; font-weight: 500;"> <i
                                    class="bi bi-trash3 me-1"></i> Delete
                                </a>


                            </div>
                        </td>
                    </tr>


                    <tr th:if="${#lists.isEmpty(booksDTO)}">
                        <td colspan="5" class="py-5 text-center text-muted"><i
                            class="bi bi-journal-x opacity-25" style="font-size: 3rem;"></i>
                            <p class="mt-3">No books found in your catalog.</p></td>
                    </tr>

                </tbody>
            </table>
        </div>
    </div>
    </div>

    <!-- Scripts -->
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>